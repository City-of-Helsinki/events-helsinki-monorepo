# Base SonarQube configuration for City of Helsinki Frontend projects
sonar.projectKey = City-of-Helsinki_events-components
sonar.organization=city-of-helsinki
sonar.javascript.lcov.reportPaths=./coverage/lcov.info
sonar.sourceEncoding=UTF-8
sonar.sources=src

# Exclude non-analyzable files: test infrastructure, type declarations,
# library assets, generated GraphQL code, and infrastructure-only files
sonar.exclusions= \
  **/__tests__/**/*, \
  **/__mocks__/**/*, \
  **/__snapshots__/*, \
  **/*.d.ts, \
  **/*.test.js, \
  **/*.test.ts, \
  **/*.test.jsx, \
  **/*.test.tsx, \
  **/*.spec.js, \
  **/*.spec.ts, \
  **/*.spec.jsx, \
  **/*.spec.tsx, \
  src/setupTests.js, \
  src/setupTests.ts, \
  src/assets/**, \
  src/styles/**, \
  src/types/**, \
  src/loggers/**, \
  **/*.query.ts, \
  **/query.ts, \
  src/i18n.ts, \
  src/components/document/Document.tsx

# Analyze for quality issues but exclude from coverage metrics:
# storybook files, entry points, service workers, and icon components (no testable logic)
sonar.coverage.exclusions= \
  **/*.stories.js, \
  **/*.stories.ts, \
  **/*.stories.jsx, \
  **/*.stories.tsx, \
  src/index.js, \
  src/index.jsx, \
  src/index.ts, \
  src/index.tsx, \
  src/serviceWorker.js, \
  src/serviceWorker.ts, \
  **/*Icon.tsx, \
  **/*Icon.ts

sonar.test.inclusions= \
  **/__tests__/**/*, \
  **/*.test.js, \
  **/*.test.ts, \
  **/*.test.jsx, \
  **/*.test.tsx, \
  **/*.spec.js, \
  **/*.spec.ts, \
  **/*.spec.jsx, \
  **/*.spec.tsx

# Ignore "Refactor this code to not nest functions more than 4 levels deep." in test files,
# because it's mostly raised when describe-functions are used.
#
# Rule: typescript:S2004
# Name: "Refactor this code to not nest functions more than 4 levels deep."
# URL: https://rules.sonarsource.com/typescript/RSPEC-2004/
sonar.issue.ignore.multicriteria.e1.ruleKey=typescript:S2004
sonar.issue.ignore.multicriteria.e1.resourceKey=**/*.test.tsx


# Ignore "Prefer `node:fs/promises` over `fs/promises`" in test files,
# because the "node:" -packages does not work in CI-pipelines.
#
# Rule: typescript:S7772
# Name: "Node.js built-in modules should be imported using the "node:" protocol"
# URL: 
# - https://next.sonarqube.com/sonarqube/coding_rules?q=s7772&open=typescript%3AS7772
# - https://github.com/sindresorhus/eslint-plugin-unicorn/blob/HEAD/docs/rules/prefer-node-protocol.md
# - https://nodejs.org/api/esm.html#node-imports
# - https://tc39.es/ecma262/#sec-modules
sonar.issue.ignore.multicriteria.e2.ruleKey=typescript:S7772
sonar.issue.ignore.multicriteria.e2.resourceKey=**/*.test.tsx
